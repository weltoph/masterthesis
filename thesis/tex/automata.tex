\chapter{Languages and Automata}
It is well established to rely on finite automata to recognize languages of
infinite objects, e.g. trees or words \cite{LangAutoLog}. In this chapter we
recall some known results for languages of infinite words and infinite trees.
Furthermore, building upon the work in \cite{RandAutoInfTrees}, we introduce and
examine a new class of tree automata, called \aclp*{WDTA}. In Chapter
\ref{chapter:synthesis} we use these class of automata to (re-)prove some
synthesis results in the context of probabilistic environments.

\section{$\omega$-regular Languages}
Following \cite{LangAutoLog} we introduce word automata with the following
structural definition
\begin{definition}[Word Automaton]
  We define a word automaton as
  $\mathcal{A} = \tuple{Q, \Sigma, q_{0}, \Delta}$ where
  $Q$ is a set of states, $\Sigma$ a finite alphabet, $q_{0}\in Q$ is the
  initial state and $\Delta\subseteq Q\times\Sigma\times Q$ is the transition
  relation. We define some associated notions as follows:
  \begin{description}
    \item [Run]
      For a word $\alpha = \alpha_{0}\alpha_{1}\dots\in\Sigma^{\omega}$ we call
      a sequence $\pi = \pi_{0}\pi_{1}\dots \in Q^{\omega}$ a run of
      $\mathcal{A}$ on $\alpha$ if $\pi_{0} = q_{0}$ and for every
      $i\in\mathbb{N}$ holds that
      $\tuple{\pi_{i}, \alpha_{i}, \pi_{i+1}}\in\Delta$
    \item [Determinism]
      We call $\mathcal{A}$ deterministic if for every pair $q\in Q$ and
      $\sigma\in\Sigma$ the set
      $\set{p\in Q\mid\tuple{q,\sigma,p}\in\Delta}$ has at most one
      element.
  \end{description}
\end{definition}
and expand upon this structure by classifying runs on word automata as
accepting or non-accepting by the following conditions:
\begin{definition}[Acceptance Conditions]
  For a word automaton $\mathcal{A} = \tuple{Q, \Sigma, q_{0}, \Delta}$ we
  define different acceptance conditions. For this we define for a run
  $\pi = \pi_{0}\pi_{1}\dots\in Q^{\omega}$ the operator
  $\Inf$ as the set of states that occur infinitely in a run, i.e.
  \begin{equation*}
    \Inf(\pi) = \set{q\in Q\middle| \text{ there are infinitely many }
    i\in\mathbb{N} \text{ s.t. } \pi_{i} = q}
  \end{equation*}
  With this notion we define the following acceptance conditions:
  \begin{description}
    \item [Büchi] A Büchi condition is defined by a set of final states
      $F\subseteq Q$ and we call a run $\pi$ accepting if
      $\Inf(\pi)\cap F\neq\emptyset$.
    \item [Muller] Muller conditions are given as a family of state sets, i.e.
      $\mathcal{F}\subseteq 2^{F}$. A run $\pi$ is called accepting if
      $\Inf(\pi)\in\mathcal{F}$.
    \item [Rabin] This acceptance condition is represented by a set of pairs\\
      $\Omega = \set{\tuple{E_{0}, F_{0}}, \dots, \tuple{F_{n}, E_{n}}}$ and we
      call a run $\pi$ accepting if there is an $i$ s.t.
      $\Inf(\pi)\cap F_{i}\neq\emptyset$ but $\Inf(\pi)\cap E_{i} = \emptyset$.
    \item [Streett] The Streett condition is dual to the Rabin condition and
      thus also given by a set of pairs
      $\Omega = \set{\tuple{E_{0}, F_{0}}, \dots, \tuple{F_{n}, E_{n}}}$. But
      this time we want that the Rabin condition is not fulfilled, i.e. for a
      run $\pi$ and all $i$ we have either $\Inf(\pi)\cap F_{i} = \emptyset$ or
      $\Inf(\pi)\cap E_{i} \neq \emptyset$.
    \item [Parity] This condition is defined
      by a function
      $\parity:Q\rightarrow \mathbb{N}$. We call a run $\pi$ accepting if the
      maximum of the set $\parity(\Inf(\pi))$, which describes the pointwise
      application of $\parity$ to the set $\Inf(\pi)$, is even (note that due
      to the finiteness of $Q$, $\Inf(\pi)$ is finite as well and thus the
      maximum of $\parity(\Inf(\pi))$ exists).
  \end{description}
\end{definition}\fxfatal{find fitting reference for parity condition} 
We categorize word automata by their acceptance condition and if they are
deterministic. Thus, we call - for example - a word automaton $\mathcal{A}$
equipped with a Büchi condition a \ac{NBA} or respectively \ac{DBA} if
$\mathcal{A}$ is deterministic. And analogously we obtain word automata for
Muller, Rabin, Streett and Parity conditions and corresponding acronyms.
\acuse{NMA}
\acuse{DMA}
\acuse{NRA}
\acuse{DRA}
\acuse{NSA}
\acuse{DSA}
\acuse{NPA}
\acuse{DPA}
It is known that all these automata (except for \acp{DBA}) do have the same
expressiveness.
\begin{theorem}
  \cite[Proposition 5.3, Theorem 5.4, Proposition 5.6]{LangAutoLog}
  \fxfatal{find one fitting reference}
  The class of recognizable languages coincides for \acp{NBA}, \acp{NMA},
  \acp{DMA}, \acp{NRA}, \acp{DRA}, \acp{NSA}, \acp{DSA}, \acp{NPA} and
  \acp{DPA}.
\end{theorem}

\section{Probabilistic Büchi Automata}
Upon the concept of \acp{NBA} there are approaches to substitute the
non-deterministic choices by probabilities for the choices
(see \cite{RecOmeLangProbAuto,DecProblemsForProbAuto,Groesser}). In order to
properly define these automata we introduce the concept of \aclp{MDP}.
\aclp*{MDP} can be used to model a system which reacts to the actions of an
agent (often called player) probabilisticly.\fxfatal{more general reference for
MPD}
More formally we use these definitions which follow \cite{RandAutoInfTrees}:
\begin{definition}[Markov Decision Process]
  A \acl*{MDP} is modelled as tuple
  $\tuple{S, A, \tuple{\tau_{a}}_{a\in A}, s_{0}}$ where $S$ is a set of states
  and $A$ a set of actions. Given an action $a\in A$ the corresponding
  transition function $\tau_{a}:S\times S\rightarrow \interval{0,1}$ satisfies
  for every $q\in S$ that $\sum_{p\in S}\tau_{a}\tuple{q,p} = 1$.
  $s_{0}$ is the initial state. Additionally we define a few helpful
  auxilliaries:
  \begin{description}
    \item [Cylinder] For a finite word of states $w\in S^{*}$ we define the
      corresponding cylinder as the set of all infinite state-sequences
      that can prolong $w$: $\cyl(w) = w\cdot S^{\omega}$.
    \item [Plays] We consider all infinite sequences of states
      (i.e. $S^{\omega}$) that start in $s_{0}$ a valid play. All plays
      are gathered in $\plays = \set{
        \alpha\in S^{\omega}\mid \alpha_{0} = s_{0}} = \cyl(s_{0})$.
    \item [Strategy] We define $\varphi:S^{+}\rightarrow A$ as strategy for
      a \ac{MDP}. Such a strategy models interaction with a \ac{MDP} by
      giving a specific $a\in A$ to which the \ac{MDP} reacts by $\tau_{a}$.
    \item [Initial Distribution] Occasionally, we substitute the initial state
      $s_{0}$ with an initial probability distribution
      $\iota_{0}:S\rightarrow[0,1]$ which allows the plays to start in any
      $s\in S$ such that $\iota_{0}(s) > 0$.
  \end{description}
  \fxfatal{again find nice reference for the general mdp things}
  \label{def:mdp}
\end{definition}
We examine the ring induced by the set of cylinders of a \ac{MDP} $\mathcal{A}$
and for a given strategy $\varphi_{\mathcal{A}}$ we obtain an induced
probability for the cylinders as follows:
\begin{equation}
  \mu_{\varphi}(\cyl(w = w_{0}\dots w_{n})\cap\plays) = \begin{cases}
    \prod_{i=1}^{n-1}\tau_{\varphi(w_{0}\dots w_{i})}(w_{i}, w_{i+1})
      &\text{ if }\cyl(w)\cap\plays\neq\emptyset\\
    0 &\text{ otherwise}
  \end{cases}
\end{equation}
We can close the set of cylinders under finite union by associating
the probability measure for $\cyl(v)\cup\cyl(u)$ to the sum of both cylinders
if $u$ and $v$ are two finite words but neither $v$ is prefix of $u$ nor $u$
is prefix of $v$.
\begin{equation}
  \mu_{\varphi}(\cyl(v)\cup\cyl(u)) = \mu_{\varphi}(\cyl(v)) 
  + \mu_{\varphi}(\cyl(u))
\end{equation}
In this fashion we obtained a pre-measure (induced by a strategy $\varphi$) on
the ring of cylinders (cp. \cite[Chapter 1 and Chapter 3]{Bauer}). This
pre-measure can now be uniquely extended to a probability measure on the
$\sigma$-algebra induced by the set of cylinders \cite[Theorem 5.4]{Bauer}.

Given this definition of \acp{MDP} we can now examine \acp{PBA}. A \ac{PBA}
essentially is a \ac{NBA} where the non-determinism is solved by a probability
distribution. More formally, we define analogously to \cite{Groesser}
\begin{definition}[Probabilistic Büchi Automata]
  A \acl{PBA} $\mathcal{A}$ over a finite alphabet $\Sigma$ is defined by a
  tuple $\tuple{Q, \Sigma, \delta, q_{0}, F}$ where $Q$ is a finite state set,
  $q_{0}\in Q$ the initial state,
    $\delta:Q\times\Sigma\times Q\rightarrow \interval{0,1}$
  a transition probability function such that for all pairs $q\in Q$ and
  $\sigma\in\Sigma$ we have $\sum_{p\in Q}\delta(q,\sigma,p)\in\set{0,1}$
  and $F\subseteq Q$ is the set of final states.
\end{definition}
Note that this definition may also be altered to allow initial distributions
rather than one initial state \cite{RecOmeLangProbAuto}.
\acp{PBA} can be interpreted as \acp{MDP} where the decisions in every state
are induced by a word $\alpha = \alpha_{1}\alpha_{2}\dots\in\Sigma^{\omega}$
rather than a player. For a \ac{PBA} $\mathcal{A}$ we can easily define a
corresponding strategy $\varphi_{\alpha}:Q^{+}\rightarrow\Sigma$ for the
equivalent \ac{MDP} $\mathcal{M}_{\mathcal{A}} =
   \tuple{Q, \Sigma, \tuple{\tau_{\sigma}}_{\sigma\in\Sigma}, q_{0}}$
where $\tau_{\sigma}(q,p) = \delta(q,\sigma,p)$ as
$\varphi_{\alpha}(w) = \alpha_{\size{w}}$. This strategy yields a probability
measure $\mu_{\alpha}$ on $Q^{\omega}$ and we can define whether $\mathcal{A}$ 
accepts $\alpha$ by this measure; namely by the measure of the set
$\mathcal{F}\subseteq Q^{\omega}$ of words that satisfy the Büchi condition
given by $F_{\mathcal{A}}$. It is known that this set $\mathcal{F}$ is
measurable and we define different acceptance conditions \cite{Groesser}:
\begin{description}
  \item [Positive Acceptance] $\mu_{\alpha}(\mathcal{F}) > 0$
  \item [Almost-Sure Acceptance] $\mu_{\alpha}(\mathcal{F}) = 1$
  \item [Threshold Acceptance] $\mu_{\alpha}(\mathcal{F}) > \lambda$ for a
    fixed threshold $\lambda\in[0, 1)$
\end{description}

Examining an induced strategy $\varphi_{\alpha}$ of a word
$\alpha\in\Sigma^{\omega}$ it is noteworthy that the strategy operates
indifferently regarding the state the play is in. We use this observation to
motivate the introduction of \acp{POMDP}. A \ac{POMDP} is a \ac{MDP}
$\mathcal{M}$ with an associated equivalence relation $\sim$
\cite{RandAutoInfTrees}. The equivalence relation models a restriction of the
player to observe the state of $\mathcal{M}$. For every
$s\in S_{\mathcal{M}}$ we define
$[s]_{\sim} = \set{r\in S\mid \sim(r,s)}$ and
$S_{\mathcal{M}}/_{\sim}$ as set of all these equivalence classes. A
strategy for a \ac{POMDP} $\tuple{\mathcal{M}, \sim}$ is defined as
$\varphi:(S_{\mathcal{M}}/_{\sim})^{+}\rightarrow A_{\mathcal{M}}$.
\begin{example}
  Re-examining a \ac{PBA} $\mathcal{A}$ and the equivalent \ac{MDP}
  $\mathcal{M}$ we observed that every word $\alpha$ induces a corresponding
  strategy $\varphi_{\alpha}$. But not every strategy induces a word because
  strategies on $\mathcal{M}$ may choose depending on the state of the play
  different letters for plays of the same length which creates an inconsistency
  with respect to an - hypothetical - associated word. To tackle this, we add
  to $\mathcal{M}$ an equivalence relation
  $\sim = S_{\mathcal{M}} \times S_{\mathcal{M}}$ (as suggested in
  \cite{DecProblemsForProbAuto}), hence there is exactly one equivalence class.
  Firstly, we observe that $\varphi_{\alpha}$ is still a valid strategy for the
  resulting \ac{POMDP} $\mathcal{P} = \tuple{\mathcal{M}, \sim}$. Secondly,
  since there is exactly one equivalence class every strategy for $\mathcal{P}$
  observes at any time only the length of the history. Hence we can provide an
  equivalent strategy of the form $\varphi:\mathbb{N}\rightarrow \Sigma$. This
  in turn means that every strategy in $\mathcal{P}$ induces a word in
  $\Sigma^{\omega}$ of the form $\varphi(0)\varphi(1)\dots$. Furthermore, the
  measure of one strategy and an associated word coincide, i.e. the language of
  $\mathcal{A}$ can be understood as strategy space for $\mathcal{P}$ and vice
  versa. This illustrates an idea which is used to define emptiness games for
  certain automata (e.g. \cite[Proposition 45]{RandAutoInfTrees}).
  \label{ex:pba}
\end{example}

\section{Tree Automata}
\fxfatal{elaborate on classical tree automata}
Building upon \cite{RandAutoInfTrees} we expand on the notion of weighting
the different paths of the run. Hereby, we incorporate the concept of
\emph{alternation} by allowing to send different states on the same path
through the tree with individual weight. Thus, we capture on transition in a
probability function over states and directions of an automaton.
\begin{definition}[Generator]
  For a set of states $Q$ and a set of directions $D$ we call a probability
  function on $Q\times D$, i.e. $G: Q\times D\rightarrow [0,1]$ with
  $\sum\limits_{\substack{q\in Q\\ d\in D}}G(q,d) = 1$, a generator over $Q$
  and $D$. A finite non-empty set of generators over sets $Q$ and $D$ is called
  a clause $C = \set{G_{1},\dots,G_{n}}$.
\end{definition}
With these transitions we adapt the common concepts of tree automata by
allowing the automaton to build a run of \enquote{transitions}.
\begin{definition}[Weighted Descent Tree Automaton]
  We define a \acl{WDTA} as tuple
  $\mathcal{A} = \tuple{Q, q_{0}, D, \Sigma, \Delta, T}$ where $Q$ is a finite
  set of states, $q_{0}$ the initial state, $D$ a finite set of directions,
  $\Sigma$ is a finite Alphabet and $T\subseteq Q^{\omega}$ is a
  $\omega$-regular target of infinite words of elements in $Q$. The transitions
  in $\Delta$ are given as clauses for every state and symbol:
  $\Delta:Q\times\Sigma\rightarrow\mathcal{C}^{Q}_{D}$
  where $\mathcal{C}^{Q}_{D}$ denotes the set of all clauses over $Q$ and $D$.
  Additionally, we define the set of all used generators as
  $\mathcal{G}_{\mathcal{A}} = \bigcup\limits_{q\in Q,\sigma\in\Sigma}
    \Delta(q,\sigma)$.
\end{definition}
The semantics of a \ac{WDTA} $\mathcal{A}$ is given as a run over a
prefix-closed $T\subseteq(Q\times D)^{*}$ with
$r:T\rightarrow \mathcal{G}_{\mathcal{A}}$ and for a tree
$t:D^{*}\rightarrow\Sigma$ with $r(\epsilon)\in\Delta(q_0, t(\epsilon))$ and
for every $\tuple{q_{1},d_{1}}\dots\tuple{q_{n},d_{n}}\in T$ we
have $r(\tuple{q_{1},d_{1}}\dots\tuple{q_{n},d_{n}}) = G\in
  \Delta(q_{n},t(d_{1}\dots d_{n}))$ and for every $\tuple{q,d}\in\supp(G)$
$\tuple{q_{1},d_{1}}\dots\tuple{q_{n},d_{n}}\tuple{q,d}\in T$. Analogously to a
strategy in Definition \ref{def:mdp} a run induces a probability measure on the
set of cylinders over $(Q\times D)$ by
\begin{equation}
  \mu_{r}(\cyl(\tuple{q_{1},d_{1}}\dots\tuple{q_{n},d_{n}}))
    = r(\epsilon)(q_{1},d_{1})\cdot\prod\limits_{i = 1}^{n - 1}
    r(\tuple{q_{1},d_{1}}\dots\tuple{q_{i},d_{i}})(q_{i+1},d_{i+1})
\end{equation}
for every $\tuple{q_{1},d_{1}}\dots\tuple{q_{n},d_{n}}\in T$ and $0$ otherwise.
Naturally, we want to define acceptance of a run in terms of its induced
measure on the set of paths that satisfy the target $T_{\mathcal{A}}$ when
projected to the state component. Thus, we show (by adapting the proof for
\cite[Proposition 6]{RandAutoInfTrees}) the measurability of that set.
\begin{lemma}[Measurability]
  The set
  \begin{equation*}
    \set{\alpha = \tuple{q_{1},d_{1}}\tuple{q_{2},d_{2}}\dots\in
    (Q\times D)^{\omega}\mid q_{0}q_{1}q_{2}\dots\in T_{\mathcal{A}}}
  \end{equation*} is measurable in the $\sigma$-algebra that is induced by the
  ring of cylinders.
  \label{lem:measureabilityAcceptance}
\end{lemma}
\begin{proof}
  We start with the co-Büchi condition which is dual to the Büchi condition.
  Specifically, a co-Büchi condition is also defined by a set of
  states $E\subseteq Q$ which in contrast must eventually be avoided. More
  precisely, such a set $E$ defines the accepted language as
  $\set{\alpha_{0}\alpha_{1}\dots\in Q^{\omega}\mid\text{ there is } i
  \text{ such that for all } j>i \text{ holds }\alpha_{j}\notin E}$.
  By abuse of notation we write in the following
  $\tuple{q, d}\in E$ if $q\in E$. With
  \begin{equation*}
    \prolong(u) = \set{v\in (Q\times D)^{*}\mid u\sqsubseteq v}
  \end{equation*} and
  \begin{equation*}
    T = \set{\alpha_{0}\alpha_{1}\dots\in (Q\times D)^{\omega}\mid\text{ there
    is } i \text{ such that for all } j>i \text{ holds }\alpha_{j}\notin E}
  \end{equation*}
  we claim that
  \begin{equation} 
    T = \bigcup\limits_{u\in (Q\times D)^{*}}(
    \cyl(u)\setminus\bigcup\limits_{v\in\prolong(u),v\in E}\cyl(v))
    \label{eq:measureability}
  \end{equation}
  which renders $T$ measurable as countable union of measurable sets.
  For $b\in T$ we know that there is eventually no occurence of $E$
  anymore. This induces that for every finite prefix $u\sqsubseteq b$ after the
  last occurence of an element in $E$ holds
  $b\notin\bigcup\limits_{v\in\prolong(u),v\in E}\cyl(v))$ and thus $b$
  is element of the right hand side of Equation \ref{eq:measureability}. On the
  other hand if $b\notin T$ we know that for every finite prefix
  $u\sqsubseteq b$ there is a prolongation $u\sqsubseteq v\sqsubseteq b$ such
  that the last element of $v$ is in $E$, hence $b$ is for every such $u$
  removed with by the cylinder associated with $v$ since $v\in\prolong(u)$.
  This yields that $b$ is not element of the right hand side of Equation
  \ref{eq:measureability} which proves the proclaimed equality. Additionally,
  we get measureability of all Büchi conditions $F\subseteq Q$ by using its
  duality to the co-Büchi condition $Q\setminus F$ and the closure of a
  $\sigma$-algebra under complementation.

  For a parity condition we get finitely many parities as
  $\parity(Q) = \set{d_{1},\dots,d_{n}}$. We define for an arbitrary set
  $E\subseteq Q$ the set $\cob(E)$ which is the set of accepted paths if
  $E$ is interpreted as co-Büchi condition and $\bue(E)$ which is the set of
  accepted path if $E$ is interpreted as Büchi condition. We already know that
  these sets are measureable. With these auxilliaries we can define the
  accepted paths of a parity condition $\parity$ by
  \begin{equation}
    \bigcup\limits^{1\leq i\leq n}_{d_{i}\text{ even}}\tuple{\bue(\parity^{-1}(d_{i}))
    \bigcap\bigcup\limits^{1\leq j\leq n}_{d_{j} > d_{i}, d_{j}\text{ odd}}
    \cob(\parity^{-1}(d_{j}))}
  \end{equation}
  which yields measureability of the accepted paths of a parity condition.
  Analogously, for a Muller condition $\mathcal{F} = \set{F_{1},\dots,F_{n}}$
  we can define
  \begin{equation}
    \bigcup\limits_{1\leq i\leq n}
    \tuple{\bue(F_{i})\bigcap\cob(Q\setminus F_{i})}
  \end{equation}
  Since Streett and Rabin conditions can be expressed as Muller conditions
  (see \cite[Proposition 5.3]{LangAutoLog}) this implies measurability for
  these conditions as well.
\end{proof}
In the following we often focus on parity conditions and motivate this by the
observation that parity conditions can be used to express all other conditions
(as suggested but not proven in \cite[page 24:9]{RandAutoInfTrees}).
\begin{lemma}
  For every \ac{WDTA} $\mathcal{A}$ with a Büchi, Streett, Rabin or Muller
  acceptance condition we can construct an equivalent \ac{WDTA} $\mathcal{B}$
  with a parity condition.
\end{lemma}
\begin{proof}
  Firstly, we observe that Büchi, Streett and Rabin conditions can be expressed
  as Muller conditions \cite[Proposition 5.3]{LangAutoLog}. Secondly, we
  construct for a \ac{WDTA} $\mathcal{A} = \tuple{Q, q_{0}, D, \Sigma, \Delta,
  \mathcal{F} = \set{F_{1},\dots,F_{n}}}$ with a Muller condition $\mathcal{F}$
  an equivalent \ac{WDTA} $\mathcal{B}$ with a parity condition via the use of
  a \ac{LAR} (analogously to e.g. \cite{MullerSchupp} for unweighted tree
  automata). The idea of an \ac{LAR} is to keep a record of the order of
  recently visited states which eventually stabilizes to those states seen
  infinitely often. Using a \ac{LAR} increases the state space but preserves
  the structure, especially the weighting, of a run and thus yields the same
  measure of the set of accepted paths. \fxfatal{this does not precisely follow
  Muller Schupp but InfCompGames and a reference shall be found accordingly}
  \begin{definition}[Latest Appearance Record]
    For a finite state set $Q$ define the set of permutations of elements in
    $Q$ as $\perm(Q)\subseteq Q^{\size{Q}}$ and
    \begin{equation*}
      \lar(Q) = \set{\interval{w,h}\mid w\in\perm(Q)\text{ and }1\leq
      h\leq\size{Q}}
    \end{equation*}
    Additionally we define an update function
    $\up:\lar(Q)\times Q\rightarrow\lar(Q)$ with
    \begin{equation*}
      \up(\interval{q_{1}\dots q_{n},h}, q)
      = \interval{qq_{1}\dots q_{i-1}q_{i+1}\dots q_{n},i}
      \text{ for the unique }i\text{ s.t. }q=q_{i}
    \end{equation*}
    and conclude with one auxillary definition:
    \begin{description}
      \item [Hit set] for $\ell = \interval{q_{1}\dots q_{n},h}$ we call
        $\set{q_{1},\dots,q_{h}}$ the hit set of $\ell$.
    \end{description}
  \end{definition}
  For a word $q_{1}q_{2}\dots\in Q^{\omega}$ we can obtain one associated
  sequence of elements in $\lar(Q)$ by picking one arbitrary starting value
  $\ell_{1}$ and successively applying the update operation, i.e.
  $\ell_{1}\ell_{2}\dots\in\lar(Q)^{\omega}$ with
  $\ell_{i+1} = \up(\ell_{i},q_{i})$ for all $i>0$. We can now state that
  $\Inf(q_{1}q_{2}\dots)$ moves to the beginning of the $\lar(Q)$ elements in
  the associated sequence
  \begin{lemma}
    \cite[Lemma 2.1]{MullerSchupp}
    $\Inf(q_{1}q_{2}\dots) = F$ if and only if from one $k>0$ the hit set of
    all $\ell_{i}$ for $i>k$ is a subset of $F$ and there are infinitely many
    $i>k$ s.t. the hit set of $\ell_{i}$ coincides with $F$.
  \end{lemma}
  This Lemma induces that the sequence of hit sets stabilises to the set
  $\Inf(q_{1}q_{2}\dots)$. Thus, $q_{1}q_{2}\dots$ satisfies a Muller condition
  $\mathcal{F}$ if and only if the hit sets stabilises to an element of
  $\mathcal{F}$. This can be captured within a parity condition by associating
  to $\ell = \interval{p_{1}\dots p_{n},h}$ with hit set
  $H = \set{p_{1},\dots,p_{h}}$ a parity condition
  \begin{equation*}
    \parity(\ell) = \begin{cases}
      2\cdot\size{H} &\text{ if }H\in\mathcal{F}\\
      2\cdot\size{H}-1 &\text{ if }H\notin\mathcal{F}
    \end{cases}
  \end{equation*}
  Thus, winning hit sets do have an even and losing hit sets do have an odd
  parity and notably the highest parity value is even if and only if
  $\Inf(q_{1}q_{2}\dots)\in\mathcal{F}$.
  We construct
  $\mathcal{B}=\tuple{\lar(Q),\ell_{0}, D, \Sigma, \Delta',\parity}$ where
  $\ell_{0}$ is one arbitrary element of $\lar(Q)$ and $\parity$ is defined as
  described above for the Muller condition of $\mathcal{A}$. For every clause
  $\Delta(q,\sigma) = \set{G_{1},\dots,G_{n}}$ we define
  $\Delta'(\ell,\sigma) = \set{G_{1}',\dots,G_{n}'}$ with
  \begin{equation*}
    G_{i}'(\ell', d) = \begin{cases}
      G_{i}(q,d) &\text{ if }\ell' = \up(\ell,q)\\
      0          &\text{ otherwise}
    \end{cases}
  \end{equation*}
  This yields that every run of $\mathcal{A}$ on a tree $t$ induces a run of
  $\mathcal{B}$ on $t$ by substituting every $G$ by $G'$ and vice versa. Since
  the set of accepting paths in both runs have the same measure we obtain the
  equivalence of $\mathcal{A}$ and $\mathcal{B}$.
\end{proof}
We say that $\mathcal{A}$ accepts $t$ if an accepting run exists where the
notion of an accepting run is (analogously to \acp{PBA}) tied to an
\enquote{acceptable measure}, e.g. Positive Acceptance or Almost-Sure
Acceptance.

Additionally, we define certain structural properties on \acp{WDTA}
\begin{definition}[Structural Properties]
  A \ac{WDTA} $\mathcal{A}$ is called
  \begin{description}
    \item [choiceless] if there is at most one generator in each clause, i.e.
      for every pair $q\in Q, \sigma\in\Sigma$ holds
      $\size{\Delta(q, \sigma)} = 1$.
    \item [uni-directional] if for every clause there is at most one state send
      to every direction, i.e. for every $G\in\mathcal{G}_{\mathcal{A}}$
      there is at most one $q\in Q$ such that $G(q, d) > 0$ for all
      $d\in D$. Intuitively this means that the automaton explores every path
      with at most one state.
    \item [uniformly distributed (u.d.)] if $\mathcal{A}$ is uni-directional
      and for a direction $d\in D$ every clause agrees on the weight that is
      sent down that direction. Thus, for all $d\in D$ holds that for all
      $G_{1}, G_{2}\in\mathcal{G}_{\mathcal{A}}$ we have
      $G_{1}(q, d) = G_{2}(p, d)$ for the unique $q, p$ for which
      $G_{1}(q, d) > 0$, respectively $G_{2}(p, d) > 0$ or
      $G_{1}(q, d) = G_{2}(p, d) = 0$ for all $q, p$. Thus, we can fix a
      probability distribution $B:D\rightarrow \interval{0,1}$ such that for
      every $G\in\mathcal{G}_{\mathcal{A}}$ there is one $q\in Q$ with
      $B(d) = G(q, d)$. We call this distribution $B$ the \emph{blueprint} of
      $\mathcal{A}$. 
  \end{description}
\end{definition}
The examined tree automata in \cite{RandAutoInfTrees} are therefore captured by
uniformly distributed \acp{WDTA} over the directions $D = \set{0,1}$ with
blueprint $B(0) = B(1) = \frac{1}{2}$.

\subsection{Closure Properties}
In the following we want to explore the closure properties of the introduced
\acp{WDTA} regarding union, intersection and negation. Unsuprisingly, the
non-determinism of the model induces closure under union for certain classes in
a straightforward manner (as suggested by \cite{RandAutoInfTrees}). We
generally only examine these properties for automata over the same set of
directions and the same alphabet.
\begin{proposition}[Union - uni-directional, unrestricted]
  Uni-directional and unrestricted \acp{WDTA} are closed under union.
  \label{prop:uniunrunion}
\end{proposition}
\begin{proof}
  For two automata
  $\mathcal{A}_{1} = \tuple{Q, q_{0}, D, \Sigma, \Delta_{1}, T_{1}}$ and
  $\mathcal{A}_{2} = \tuple{P, p_{0}, D, \Sigma, \Delta_{2}, T_{2}}$ we can
  w.l.o.g. assume that $Q\cap P = \emptyset$. The union \ac{WDTA} guesses in
  the very first transition which of the automata is checked for the tree:
  \begin{equation*}
    \tuple{Q\cup P\cup\set{z}, z, D, \Sigma,
    \Delta_{1}\cup\Delta_{2}\cup\set{
      \tuple{z,\sigma}\mapsto C_{\sigma}}_{\sigma\in\Sigma}, T_{1}\cup T_{2}}
  \end{equation*}
  where $z$ is a new state and
  $C_{\sigma} = \Delta_{1}(q_{0},\sigma)\cup\Delta_{2}(p_{0}, \sigma)$. Thus,
  in $z$ the decision if a generator from $\mathcal{A}_{1}$ or
  $\mathcal{A}_{2}$ is chosen determines for which automata the run is
  generated. It is noteworthy that every run is in bijection to a run of
  $\mathcal{A}_{1}$ or $\mathcal{A}_{2}$ and thus induces the same measurement
  on the set of accepted paths and that this construction preservers
  uni-directionality.
\end{proof}
\begin{corollary}
  The class of u.d. \acp{WDTA} with a fixed blueprint $B$ is closed under
  union.
\end{corollary}
\begin{proof}
  The construction for Proposition \ref{prop:uniunrunion} respects a common
  blueprint of $\mathcal{A}_{1}$ and $\mathcal{A}_{2}$.
\end{proof}
\fxwarning{what about u.d. with different blueprints? more general question:
how are non-determinism and weighting related? orthogonal or dependent?}

Regarding intersection we observe a significant difference between positive and
almost-sure acceptance. This is rooted in the \enquote{global} nature of
almost-sure acceptance while positive acceptance can be accomplished by
\enquote{local} phenomenon, e.g. one accepted subtree somewhere in the tree.
Thus, for almost-sure acceptance a general intersection operator can separate
in the first transition the runs of both \ac{WDTA} with a probability of
$\frac{1}{2}$ each.\fxwarning{add picture} Both these runs do individually need
an acceptance measure of $1$ to render the new run almost-surely accepted.
This can be captured with the following lemma
\begin{lemma}
  A run $r:T\rightarrow \mathcal{G}_{\mathcal{A}}$ of $\mathcal{A}$ is
  almost-surely accepted if and only if every subtree of $r$ is almost-surely
  accepted.
  \label{lem:subtreeacc}
\end{lemma}
\fxfatal{heavily rewrite proof; maybe find reference for a comparable lemma}
\begin{proof}
  Considering that the examined acceptance conditions in this thesis are all
  history independent, i.e. for every $\alpha$ that satisfies an acceptance
  condition if and only if every $\beta$ with $\alpha = u\cdot\beta$ for a
  finite $u$ satisfies the condition. If all subtrees of $r$ are almost-surely
  accepted then $r$ itself. On the other hand, if not all subtrees of $r$ are
  almost-surely accepted then there is a finite path to a non accepted subtree
  with a positive measure $m$. The measure of accepted path in the subtree is
  then $n<1$, hence $r$ is at least $m\cdot n$ short of measure $1$.
\end{proof}
which yields the following theorem
\begin{proposition}
  Unrestricted \acp{WDTA} with almost-sure acceptance are closed under
  intersection.
\end{proposition}
\begin{proof}
  We introduce the intersection automaton as follows
  \begin{definition}
    For $\mathcal{A} = \tuple{Q, q_{0}, D, \Sigma, \Delta, \parity}$ and
    $\mathcal{B} = \tuple{P, p_{0}, D, \Sigma, \Delta', \parity'}$ we define
    \begin{equation*}
      \mathcal{C} = \tuple{Q\uplus P\uplus\set{b}, b, D, \Sigma,
      \Delta\uplus\Delta'\uplus\nabla, \parity\uplus\parity'\uplus
      \set{b\mapsto 0}}
    \end{equation*}
    with
    \begin{equation*}
      \Delta(q_{0},\sigma) = \set{G_{\sigma}^{1},\dots,G_{\sigma}^{n}}
      \text{ and }
      \Delta(p_{0},\sigma) = \set{K_{\sigma}^{1},\dots,K_{\sigma}^{m}}
    \end{equation*}
    we set
    \begin{equation*}
      \nabla(b,\sigma) = \bigcup^{1\leq i\leq n}_{1\leq j\leq m}\set{
        \frac{G_{\sigma}^{i}}{2} \cup \frac{K_{\sigma}^{j}}{2}}
    \end{equation*}
    where $\frac{G}{2}$ describes the halving of every function value of $G$.
  \end{definition}
  Any run $r$ of $\mathcal{C}$ on a tree $t$ consists of two parallel runs on
  $t$, namely $r_{\mathcal{A}}$ of $\mathcal{A}$ and $r_{\mathcal{B}}$ of
  $\mathcal{B}$. By Lemma \ref{lem:subtreeacc} holds that $r$ is almost-surely
  accepted if and only if every subtree of $r$ is almost-surely accepted which
  holds if and only if every subtree of $r_{\mathcal{A}}$ and $r_{\mathcal{B}}$
  is almost-surely accepted. This characterisation yields the claimed equality.
\end{proof}
For uni-directional \acp{WDTA} with common blueprint the common product
construction for intersection leads to a intersection operator, hence
\begin{proposition}
  Uni-directional \acp{WDTA} with common blueprint are closed under
  intersection.
\end{proposition}

\subsection{Emptiness}
Similarly to \acp{PBA}, we want to define for a given \ac{WDTA} $\mathcal{A}$
a game that captures the behaviour of $\mathcal{A}$. Again, this will result in
the definition of \ac{POMDP}. This game is designed to go through the following
steps:
\begin{enumerate}
  \item initially, the player chooses any $G\in\mathcal{G}_{\mathcal{A}}$
    such that $G\in\Delta(q_{0},\sigma)$ for any $\sigma\in\Sigma$
  \item then the game moves to a position $\tuple{q,d}\in\tuple{Q\times D}$
    with probability $G(q,d)$
  \item the player is not allowed to observe the state of the current position
    but may choose dependent on the observed direction $d$ one
    $\sigma\in\Sigma$ and a transition $G\in\Delta(q,\sigma)$ for every
    $q\in Q$
  \item the game proceeds to any $\tuple{q,d}$ with the corresponding
    probability $G(q,d)$
\end{enumerate}
Similiar to Example \ref{ex:pba} a strategy only represents a tree if for every
play the choice of a letter $\sigma$ is consistent throughout all plays
associated with one certain word of directions. Therefore, we introduce in the
choice of the player the restriction of observation in step $3$. This allows
the player to exclusively observe the directions taken throughout the game and
base her/his decision of which letter to place on this observation only.
\begin{definition}[Emptiness Game]
  For a \ac{WDTA} $\mathcal{A} = \tuple{Q, q_{0}, D, \Sigma, \Delta, T}$ we
  fix the set of actions $A$ for the player as a set
  \begin{equation*}
    A = Q\rightarrow\Delta_{\Sigma}
  \end{equation*}
  where $\tuple{Q\rightarrow\Delta_{\Sigma}}$ is the set of functions that map
  for one fixed $\sigma$ a state $q\in Q$ to a generator in $\Delta(q,\sigma)$.
  Let $\sigma(f)$ for $f\in\tuple{Q\rightarrow\Delta_{\Sigma}}$ be the
  associated element in $\Sigma$ for $f$. The emptiness game is then defined as
  a \ac{POMDP}
  \begin{equation*}
    \mathcal{M}_{\mathcal{A}} = \tuple{\tuple{Q\times D}\uplus \set{q_{0}}, A,
    \tuple{\tau_{a}}_{a\in A}, q_{0}}
  \end{equation*}
  where
  \begin{equation*}
    \tau_{f}(\tuple{q,d},\tuple{q',d'}) = f(q)(q',d')
  \end{equation*}
  and the associated observation relation is $\sim$ with
  \begin{equation*}
    \tuple{q, d}\sim\tuple{p, d'}\text{ if and only if } d = d'
  \end{equation*}
\end{definition}
In order to prove the viability of this game definition we show that a strategy
$s$ can be understood as a tree $t$ and that the induced probability measure on
paths coincides with a run $r$ of $\mathcal{A}$ on $t$. And for any associated
measureable objective $\mathcal{O}\subseteq Q^{\omega}$ which can be projected
onto the states of $\mathcal{M}_{\mathcal{A}}$ by only considering the state
component of any position in the play the measures of plays in
$\mathcal{M}_{\mathcal{A}}$ and in the run-tree coincide. Thus, we get
\begin{theorem}
  There is a strategy $s$ which ensures that an objective
  $\mathcal{O}\subseteq Q^{\omega}$ is positively (resp. almost-surely)
  satisfied in $\mathcal{M}_{\mathcal{A}}$ if and only if there is tree $t$ and
  a run $r$ of $\tuple{\mathcal{A},\mathcal{O}}$ on $t$ which is positively
  (resp. almost-surely) accepted.
  \label{thm:emptinessgame}
\end{theorem}
\begin{proof}
  First of all, we recall that any strategy for $\mathcal{M}_{\mathcal{A}}$ is
  defined as a function which chooses for any finite play the next action, i.e.
  $s:\tuple{\tuple{Q\times D}\uplus\set{q_{0}}}^{+}\rightarrow A$. But
  considering the properties of the game closely the strategy can be reduced to
  its effective core. By the restriction of observation every such strategy
  only observes the directions and thus can be expressed as a function of the
  form $s:\tuple{D\uplus\set{q_{0}}}^{+}\rightarrow A$. Secondly, we define
  $P = \set{\alpha_{1}\alpha_{2}\dots\in\tuple{\tuple{Q\times D}\uplus
  \set{q_{0}}}^{+}\mid \alpha_{0} = q_{0}\text{ and there is no }i>0
  \text{ s.t. }\alpha_{i} =q_{0}}$
  and argue that only plays in $P$ actually do matter in the game.
  \begin{lemma}
    Every two strategies $s,s'$ that agree on all finite prefixes of
    observations of plays in $P$ induce the same measure for plays in
    $\mathcal{M}_{\mathcal{A}}$.
  \end{lemma}
  \begin{proof}
    The begin of any play in $q_{0}$ is by definition of \acp{POMDP} and the
    fact that $q_{0}$ is the initial state. Furthermore, consider any finite
    prefix $u\in\tuple{\tuple{Q\times D}\uplus \set{q_{0}}}^{+}$ of a play
    $\beta\notin P$. And let $i$ be the index of the second occurence of
    $q_{0}$ in $u$. By the definition of $\mathcal{M}_{\mathcal{A}}$ the
    movement from $u_{i-1}$ to $u_{i}$ has a probability of $0$ regardless of
    the choice of either $s$ or $s'$. This yields
    $\mu_{s}(\cyl(u_{0}\dots u_{i})) = \mu_{s'}(\cyl(u_{0}\dots u_{i})) = 0$.
    Thus, only plays in $P$ possibly do have a positive measure, hence
    strategies that coincide in these plays are equivalent.
  \end{proof}
  We can therefore regard any strategy as a function
  $s:q_{0}\cdot D^{*}\rightarrow A$ and extract an associated tree $t$ by
  $t(u) = \sigma(s(q_{0}\cdot u))$ for any $u\in D^{*}$ and also a run $r$ of
  $\mathcal{A}$ on $t$ by setting for
  $\tuple{q_{0}, d_{0}}\dots\tuple{q_{n}, d_{n}}\in\tuple{Q\times D}^{*}$ and
  $f = s(q_{0}d_{0}d_{1}\dots d_{n})$:
  $r(\tuple{q_{0}, d_{0}}\dots\tuple{q_{n}, d_{n}}) = f(q_{n})$ which is by
  definition of $f$ a valid generator from $\Delta(q_{n}, t(d_{0}\dots d_{n}))$.
  In this fashion we can biject plays of the emptiness game to paths in the
  run-tree which induce the same probability measure implying the claim.
\end{proof}
\begin{corollary}[Emptiness Almost-Sure Büchi WDTA]
  The emptiness problem for a \ac{WDTA} with almost-sure acceptance measure of
  a Büchi condition can be decided in exponential time.
  \label{cor:emptiness}
\end{corollary}
\begin{proof}
  Apply \cite[Theorem 5]{QualAnaPOMDP} to the corresponding emptiness game.
\end{proof}
\begin{corollary}[Emptiness Almost-Sure Uni-Directional WDTA]
  The emptiness problem for an uni-directional \ac{WDTA} with almost-sure
  acceptance measure of a $\omega$-regular condition can be decided in
  polynomial time.
\end{corollary}
\begin{proof}
  Since only one state is at any time on a position in the tree the restriction
  of observation can be discarded without losing the consistency of the
  associated tree to the strategy. Then, apply
  \cite[Theorem 3]{RandAutoInfTrees} to the corresponding emptiness game.
\end{proof}
We designed for one \ac{WDTA} a corresponding emptiness game in form of an
\ac{POMDP} and in the proof to Theorem \ref{thm:emptinessgame} we used the
resemblance of a runtree to the unrollment of an \ac{POMDP} as induced by a
strategy. This naturally poses the question if a translation in the other
direction is viable and, indeed, it is.
\begin{theorem}
  \label{thm:POMDPequivWDTA}
  For every \ac{POMDP} $\mathcal{M}$ exists an \enquote{equivalent}
  deterministic \ac{WDTA} $\mathcal{A}$ with the same state space.
\end{theorem}
\begin{proof}
  Let $\mathcal{M} = \tuple{S, A, \tuple{\tau_{a}}_{a\in A}, s_{0}, \sim}$ be a
  \ac{POMDP}. We can extract the possible observations in $\mathcal{M}$ and
  gather them as $O = \set{\interval{s}_{\sim}\mid:s\in S}$. A strategy for
  $\mathcal{M}$ therefore is only dependent on the sequence of observations up
  to the current state of play, i.e. a word in $u\in s_{0}O^{*}$. Fixing the
  set of directions and the set of letters for a tree $t$ to $O$ and $A$
  respectively renders $t:O^{*}\rightarrow A$ as a viable strategy $s$ for
  $\mathcal{M}$ by identifying $t(u)$ with $s(s_{0}\cdot u)$. This naturally
  leads to
  \begin{definition}
    For $\mathcal{M} = \tuple{S, A, \tuple{\tau_{a}}_{a\in A}, s_{0}, \sim}$
    with $O = \set{\interval{s}_{\sim}: s\in S}$ define
    \begin{equation*}
      \mathcal{A} = \tuple{S, s_{0}, O, A, \Delta}
    \end{equation*}
    where
    \begin{equation*}
      \Delta(s, a\in A) = \set{G_{s}^{a}}\text{ and }
      G_{s}^{a}(s', o) = \begin{cases}
        \tau_{a}(s, s')&\text{ if }o = \interval{s'}_{\sim}\\
        0              &\text{ otherwise}
      \end{cases}
    \end{equation*}
  \end{definition}
  Thus, from the current state those states with observation $o\in O$ are sent
  in direction $o$. Therefore, the unique run $r$ on any tree $t$ yields for a
  state sequence $u\in S^{*}$ and a sequence of observations $v\in O^{\size{u}}$
  that
  \begin{equation*}
    \mu_{r}(\cyl(\tuple{u_{0},v_{0}}\dots\tuple{u_{n},v_{n}})) =
    \begin{cases}
      \prod_{0\leq i\leq n-1}\tau_{t(v_{0}\dots v_{i})}(u_{i}, u_{i+1})
        &\text{ if }u_{0} = s_{0}\text{ and }\interval{u_{i}}_{\sim} = v_{i}\\
      0 &\text{ otherwise}
    \end{cases}
  \end{equation*}
  which coincides with the measure for $\mu_{s}(\cyl(u))$ in $\mathcal{M}$.
\end{proof}

\subsection{Equivalence of \acp*{WDTA} and \acp*{PBA}}
By reducing the directions to a singelton set a tree degenerates to a single
path. This path can be interpreted as one word and thus, we can incorporate the
concept of \acp{PBA} into the theory of \acp{WDTA} by the following theorem
\begin{theorem}
  For every \ac{PBA} $\mathcal{P}$ existent an equivalent \ac{WDTA}
  $\mathcal{A}$ and for every choiceless \ac{WDTA} $\mathcal{A}$ with
  $\size{D_{\mathcal{A}}} = 1$ exists an equivalent \ac{PBA}.
  \label{theorem:pbaequiv}
\end{theorem}
\begin{proof}
  For a \ac{PBA} $\mathcal{P} = \tuple{Q, \Sigma, \delta, q_{0}, F}$ we define
  \ac{WDTA} $\mathcal{A} = \tuple{Q, q_{0}, \set{0}, \Sigma, \Delta, F}$ with
  $\Delta(q,\sigma) = \set{G_{q}^{\sigma}}$ and
  $G_{q}^{\sigma}(p, 0) = \delta(q, \sigma, p)$. A word
  $\alpha\in\Sigma^{\omega}$ can be expressed equivalently as function
  $\alpha:\mathbb{N}\rightarrow\Sigma$ and with the bijective mapping of $0^n$
  to $n$ we obtain an equivalent tree $\alpha:\set{0}^{*}\rightarrow\Sigma$.
  The (unique) run of $\mathcal{A}$ on $\alpha$ is in bijection to the runtree
  of $\mathcal{P}$ on $\alpha$ which yields the claimed equality.
\end{proof}
This directly entails some undecideability results carried over from \acp{PBA}.
\begin{corollary}
  The undecideability of the emptiness problem for \acp{PBA} with positive
  acceptance \cite{Groesser} renders the emptiness problem for \acp{WDTA} with
  positive acceptance undecideable.
\end{corollary}
\begin{corollary}
  The emptiness problem for \acp{WDTA} with almost-sure acceptance is
  undecideable.
\end{corollary}
\begin{proof}
  By \cite[Proof of Theorem 1]{DecProblemsForProbAuto} there is an equivalent
  probabilistic Rabin automaton for which the accepted paths have either
  measure $0$ or $1$ for every \ac{PBA} with positive acceptance. Thus, for the
  the equivalent \ac{WDTA} to this probabilistic Rabin automaton positive and
  almost-sure acceptance coincides rendering the emptiness problem for both
  acceptance criteria undecideable.
\end{proof}
Note that this undecideability result does not contradict the decideable
emptiness for \acp{WDTA} with Büchi condition and almost-sure acceptance but
simply shows that Büchi conditions are less expressive (as it is for
non-weighted tree automata\fxfatal{find reference}).

Having used the fact that moving from Büchi to Rabin acceptance conditions
allow for \acp{PBA} to allow an almost-sure acceptance rather than a positive
acceptance sparks the question if this can be translated to choiceless
\acp{WDTA} as well. Unfortunately, this question can be answered negatively
with
\begin{proposition}
  There exists a language that is accepted by a choiceless \ac{WDTA} with a
  positive acceptance of a Büchi condition that is not accepted by any
  choiceless \ac{WDTA} with a Muller condition.
\end{proposition}
\begin{proof}
  We define $\mathcal{L}_{\exists a}$ as the language of all trees with
  directions $\set{0,1}$ over the alphabet $\set{a,b}$ that do contain an $a$.
  First, we show that this language can be accepted by a choiceless Büchi
  \ac{WDTA} with positive acceptance of a Büchi condition. But this is
  straightforward by constructing a \ac{WDTA} with two states $q_{a}, q_{b}$
  where $q_{b}$ is the initial state. The final state is $q_{a}$ and we
  distribute uniformely over both branches $q_{b}$ until an $a$ occurs where
  the automaton distributes uniformely the state $q_{a}$ regardless of the read
  letter, thus $q_{a}$ is a positive sink-state. Any tree that is accepted does
  necessarily contain an $a$ since it is the only chance to produce an
  acceptance subtree and conversely, if a tree does contain an $a$ there is a
  finite path of length $n$ towards the subtree rooted at this occurence of $a$,
  hence in the run of the automaton on this tree there is an accepted subtree
  which is reached with probability $(\frac{1}{2})^{n} > 0$ rendering the run
  accepting for this tree.

  On the other hand we show that there is no choiceless \ac{WDTA} with an
  almost-sure Muller condition that accepts precisely $\mathcal{L}_{\exists a}$.
  For this consider three trees $t_{0}, t_{1}, t_{b}$ where every letter in
  $t_{i}$ is $b$ except for $t_{i}(i) = a$ for $i = 0,1$ and $t_{b}$ only
  contains $b$. Assume there is a choiceless \ac{WDTA} $\mathcal{A}$ with an
  almost-sure acceptance of a Muller condition to accept
  $\mathcal{L}_{\exists a}$. The unique runs of $A$ on $t_{0},t_{1}, t_{b}$ do
  start with the same distribution in the root since
  $t_{0}(\epsilon) = t_{1}(\epsilon) = t_{b}(\epsilon) = b$ and $\mathcal{A}$
  is choiceless and the runs on $t_{0}$ and $t_{1}$ are accepting.
  Furthermore, we can savely assume that at least on state in each direction
  does carry weight. Because if w.l.o.g. no state in direction $0$ carries any
  weight the measure on all accepted runs for the run on $t_{0}$ and $t_{b}$ is
  equal. Thus, either $t_{0}$ is not accepted or $t_{b}$ is accepted. Both
  cases contradict the assumption that $\mathcal{A}$ precisely accepts
  $\mathcal{L}_{\exists a}$. Additionally, for every state that carries weight
  in the first level of the run of $\mathcal{A}$ on either $t_{0}$ or $t_{1}$
  does need to have a almost-sure measure on its accepted paths. But those
  states on the left side produce for $t_{1}$ and $t_{b}$ the same paths, while
  the states on the right side produce for $t_{0}$ and $t_{b}$ produce the same
  paths. These paths are almost-surely accepted for $t_{0}$ (resp. $t_{1}$) and
  therefore also for $t_{b}$ rendering the unique run on $t_{b}$ almost-surely
  accepted yielding the desired contradiction and concluding the proof.
\end{proof}

\subsection{A forrest of languages}
The different structural properties of \acp{WDTA} introduce different language
classes. We explore in the following how these classes are related to each
other. First of all, we notice that determinism obviously is a restriction.
\begin{proposition}
  The class of languages recognizable with \acp{WDTA} almost-sure acceptance
  is a proper superset of languages recognizable with determinisitc \acp{WDTA}
  with almost-sure acceptance.
\end{proposition}
\begin{proof}
  For u.d. \acp{WDTA} with a common blueprint this follows from
  \cite[Proposition 10]{RandAutoInfTrees}.
  The general case is a little more elaborate but yields an interesting
  intuition: non-deterministic \acp{WDTA} allow for search of properties on
  one path while determinism entails a spread of weight and thus cannot
  recognize properties on one, finitly many or countably many paths if all
  paths are examined. \fxfatal{elaborate}
\end{proof}
It is a very interesting result that alternation in non-weighted tree automata
does not increase the general expressiveness (see \cite{MullerSchupp}).
This result does unfortunately not translate unconstraint to the weighted case.
\begin{proposition}
  The class of languages recognizable with uni-directional \acp{WDTA} with
  Büchi condition is incomparabel with the class of languages recognizable with
  choiceless \acp{WDTA} with Büchi condition under almost-sure acceptance.
\end{proposition}
\begin{proof}
  It is known from \cite[Theorem 4 (b), (c)]{DecProblemsForProbAuto} that
  $\omega$-regular languages and languages recognizable by \acp{PBA} are
  incomparable. We consider the inverse of Theorem \ref{theorem:pbaequiv} for
  \acp{WDTA} over a singleton direction set. Let $D$ be a set with $\size{D}=1$
  and $\mathcal{D} = \tuple{Q, q_{0}, D, \Sigma, \Delta, F}$ a deterministic
  \ac{WDTA}, hence w.l.o.g. (under almost-sure acceptance we can complete
  automata with a non-accepting sink state)
  $\Delta(q,\sigma) = \set{G^{q}_{\sigma}}$. We can straightforwardly define an
  equivalent \ac{PBA} $\mathcal{P} = \tuple{Q, \Sigma, \delta, q_{0}}$ with
  $\delta(q, \sigma, p) = G^{q}_{\sigma}(p, d)$ for the one $d\in D$. Since the
  runtree of $\mathcal{P}$ coincides with the unique run of $\mathcal{D}$ on
  any $\alpha$ the equivalence is obvious. Let
  $\mathcal{U} = \tuple{P, p_{0}, D, \Sigma, \Delta', F'}$ be a uni-directional
  \ac{WDTA}. Since there is only one $d\in D$ and every transition in
  $\mathcal{U}$ is only allowed to put weight into one state per direction
  every run of $\mathcal{U}$ on any $\alpha$ can be reduced to one path with
  weight $1$. This path is either accepting or non-accepting and thus
  the class of accepted languages of those \ac{WDTA} is the class of
  $\omega$-regular languages. Remarkably, we can for any \ac{PBA} define an
  equivalent uni-directional \ac{WDTA} (for any transition from $q$ to $p$ in
  the word automaton introduce a transition in the tree automaton that puts all
  its weight from $q$ to $p$). The claimed incomparability translates
  immediately from the incomparability of the word automata.
\end{proof}
\begin{corollary}
  For Büchi conditions there are deterministic \acp{WDTA} that do not have an
  equivalent uni-directional \ac{WDTA} with any acceptance measure.
\end{corollary}
\begin{proof}
  In above construction the measure of the one path of a run in an
  uni-directional \ac{WDTA} is binary ($1$ if the path is accepting and $0$
  otherwise). Thus the acceptance measures coincide. For the \ac{PBA} the
  runtree is in bijection to the run of the \ac{WDTA} and
  \cite[Theorem 4]{RecOmeLangProbAuto} states that \acp{PBA} with positive
  measure are more expressive than $\omega$-regularity.
\end{proof}

\section{Depth vs. Width}
In \cite[Chapter 4]{RandAutoInfTrees} the concept of resolving non-determinism
by probability distributions (as suggested for \acp{PBA}) is explored in the
context of weighted tree automata. Thus, the automaton does not
\enquote{build} a run by choosing fitting transitions but every transition is
explored with a certain probability. We refer to this concept as \emph{Depth}
since it can be illustrated as a number of runs executed in parallel and
weighted accordingly to the probabilities of possible choices to build the run
(see Figure \ref{fig:parallelruns}). We argue that the introduced concept of
\enquote{alternation} for weighted tree automata actually captures this concept
by allowing for a certain \emph{Width} in runs, hence we can resolve
probabilities of transitions by moving states downwards in the runtree according
to the transitions with an adapted weighting. Since resolving non-determinism
probabilistically renders an automaton literally \enquote{choiceless} we expect
the corresponding equivalent \ac{WDTA} to indeed have the choiceless property.
Additionally, we restrict the transitions to obey a certain structure, i.e. we
enforce a property which we reffered to as uniform distribution for \acp{WDTA}.
This de-couples the probability of a movement through the individual runs and
the probability of the run itself which ensures that the definition is
well-founded. Also, since resolving non-determinism with probabilities in
\acp{PBA} yields interesting results this inclusion further strengthens the
relevance of \acp{WDTA}. \fxwarning{sounds as if we are unsure about the
relevance in the first place}

\subsection{Probabilistic Weighted Automata}
In order to explore the setting of resolving non-deterministic choices by
probability distributions we introduce analogously to
\cite[Definition 4.1.1]{RandAutoInfTrees} the class of \ac{PWA} with
\begin{definition}[Probabilistic Weighted Automata]
  Fix a finite alphabet $\Sigma$, a finite set of directions $D$ and a finite
  set of states $Q$. We fix a probability distribution
  $B:D\rightarrow\interval{0,1}$ which fixes the movement through any run. The
  transitions are captured by a finite non-empty set of functions
  $\set{\delta_{1},\dots,\delta_{n}}$ with $\delta_{i}:D\rightarrow Q$ for
  $1\leq i\leq n$. A function $\Delta$ is used to map every tuple of any
  $q\in Q$ and $\sigma\in\Sigma$ to a probability distribution of the
  associated set of transitions $\set{\delta_{1},\dots,\delta_{n}}$.
  Furthermore, we introduce an $\omega$-regular target set
  $T\subseteq Q^{\omega}$ and pick one $q_{0}\in Q$ to combine all these
  elements to a \ac{PWA}
  \begin{equation*}
    \mathcal{A} = \tuple{Q, q_{0}, D, \Sigma, B, \Delta, T}.
  \end{equation*}
\end{definition}
One run of such an automaton $\mathcal{A}$ on a tree $t:D\rightarrow\Sigma$ is
differently defined than runs for \acp{WDTA} since the run does not need to
encode the weighting of paths through the run. Thus, we define one run
$r:D^{*}\rightarrow Q$ such that for every $w\in D^{*}$ there exists one
$\delta\in\supp(\Delta(r(w), t(w)))$ with $r(w\cdot d) = \delta(d)$ for
all $d\in D$ to which we refer to as $\delta_{r(w)}$ and additionally,
$r(\epsilon) = q_{0}$. As seen before, the distribution $B$ induces a measure
$\mu_{B}$ on the $\sigma$-algebra $\mathcal{F}_{\mathcal{A}}$ which is
generated by the cylinders of all $w\in D^{*}$. The set of accepting paths are
those paths which associated state sequence satisfy the target $T$:
$\Acc(r)=\set{\alpha\in D^{\omega}\mid r(\alpha)\in T}$. Semantically, $r$ is
considered almost-surely (resp. positively) accepting if $\mu_{B}(\Acc(r)) = 1$
(resp. $\mu_{B}(\Acc(r))>0$).

Additionally, to examine the probabilities induced by $\Delta$ we introduce a
$\sigma$-algebra which is generated by partial runs, i.e. finite beginnings of
runs. Therefore, we define a finite tree as a prefix-closed subset of finite
words over directions, hence
\begin{definition}[Finite Tree]
  For a finite set of directions $D$ we call a finite $T\subseteq D^{*}$ a
  prefix-tree if for every $w\in T$ an every finite prefix $v$ of $w$ holds
  $v\in T$. Additionally, we call a prefix-tree $T$ \emph{proper} if for any
  $w\in T$ exists $d\in D$ such that $w\cdot d\in T$ also $w\cdot d'\in T$ for
  all other $d'\in D$ holds. We define the \enquote{inner} nodes of $T$ as
  those notes that do have an extension in $T$ as
  $\inner(T) = \set{w\in T\mid w\cdot d\in T\text{ for any }d\in D}$.
\end{definition}
For a \ac{PWA} $\mathcal{A}$ and a tree $t:D\rightarrow\Sigma$ 
we can - depending on $t$ - define all partial runs of $\mathcal{A}$ on $t$ as
$r:T\rightarrow Q$ for any proper prefix-tree $T$. This partial run has to be
consistent with $t$. Considering such a partial run $r$ we can define the set
of runs $r'$ of $\mathcal{A}$ on $t$ such that these runs agree on $T$ with
$r$, i.e. for all $w\in T$ holds $r(w) = r'(w)$, as $\compRuns(r)$.
Analogously, to the concept of cylinders over a set we can capture a
$\sigma$-algebra $\mathcal{R}_{\mathcal{A}}$ over runs by using the sets
$\compRuns(r)$ for every partial run $r$ as generating sets. For any partial
run $r$ over the prefix-tree $T$ (and thus for the set of compatible runs with
$r$) there is an associated probability with
\begin{equation*}
  \mu_{t}(\compRuns(r)) = \prod\limits_{w\in\inner(T)}
  \Delta(r(w),t(w))(\delta_{r(w)}).
\end{equation*}
Again, as for \acp{WDTA}, this yields a pre-measure on
$\mathcal{R}_{\mathcal{A}}$ which can be uniquely extended to a measure by
\cite[Theorem 5.4]{Bauer}, hence we obtain a measurable space
$\tuple{\mathcal{R}_{\mathcal{A}}, \mu_{t}}$. In terms of this measurable space
we define the acceptance condition. In \cite{RandAutoInfTrees} different
notions of acceptance are discussed, e.g.
\begin{enumerate}
  \item without regard for the weighting induced by $B$ the semantic can be
    defined by the measure of $\mu_{t}$ of those runs that satisfy a Büchi
    condition \cite[analogously to Proposition 38]{RandAutoInfTrees},
  \item regarding the weighting of the generators multiple combinations of
    positive or almost-sure acceptance for the individual runs and positive and
    almost-sure acceptance for those runs deemed accepting.
\end{enumerate}
We want to focus on the acceptance condition of almost-sure property of those
individual runs that are almost-surely accepting. Thus, we considere a tree
accepted if almost-all runs do satisfy the almost-sure acceptance of the
objective $T$. Hence, we fix the set of all viable runs on $t$ as $\Runs$ and
the set of all possible paths in a run $\Paths = D^{\omega}$ and define for an
automaton $\mathcal{A}$ the following function within the product
$\sigma$-algebra of all runs and paths
\begin{equation*}
  f_{\mathcal{A}}:\Runs\times\Paths\rightarrow\interval{0,1}
  \text{ with }
  f_{\mathcal{A}}(r, p) = \begin{cases}
    1&\text{ if }r(p)\text{ satisfies }T\\
    0&\text{ otherwise.}
  \end{cases}
\end{equation*}
In the following we show the integrability of the function $f$ and with this
integrability we argue that the definition of the semantic of the \ac{PWA}
$\mathcal{A}$ is well-founded.
\begin{proposition}
  $f_{\mathcal{A}}$ is a measureable function w.r.t. the $\sigma$-algebra
  $\mathcal{R}_{\mathcal{A}}\otimes\mathcal{F}_{\mathcal{A}}$.
\end{proposition}
\begin{proof}
  In order to show the measureability of $f_{\mathcal{A}}$ it suffices to show
  the measureability of $f_{\mathcal{A}}^{-1} =
  \set{\tuple{r,p}\in\Runs\times\Paths\mid r(p)\in T}$ which we do in the
  following analogously to \cite[Lemma 36]{RandAutoInfTrees}. And since more
  complex conditions can be expressed as Boolean combinations of Büchi
  conditions (as used in the proof of e.g. Lemma
  \ref{lem:measureabilityAcceptance}) we examine only a Büchi condition and
  infer the result for other $\omega$-regular $T$. By
  \cite[Theorem 22.1]{Bauer} is the product $\sigma$-algebra
  $\mathcal{R}_{\mathcal{A}}\otimes\mathcal{F}_{\mathcal{A}}$ generated by the
  sets $\compRuns(r)\times\cyl(p)$ for all proper partial runs $r$ and
  $p\in D^{*}$. To ease the following argument we restrict our attention to
  partial runs that are \enquote{balanced}, i.e. all paths have the same length.
  That this restriction is purely argumentativ is ensured by
  \begin{lemma}
    The $\sigma$-algebra that is generated by balanced proper partial runs and
    the $\sigma$-algebra generated by all proper partial runs are identical.
  \end{lemma}
  \begin{proof}
    Easily to see is that the set of all proper partial runs contain all
    balanced partial runs which ensures that the algebra generated by proper
    partial runs is at most more complex than the algebra generated by balanced
    proper partial runs. On the other hand, considering one proper partial run
    $r:T\rightarrow Q$. Fix $n = \max{\size{w}:w\in T}$. Pick any $v\in T$ with
    $\size{v}<n$ and $v\cdot d\notin T$ for all $d\in D$. If no such $v$ exists
    $T$ is balanced. If not, it holds that there are only finitely many
    successor functions $\set{\delta_{1},\dots,\delta_{n}}$ associated with the
    state $r(v)$ and the letter $t(v)$. For every $1\leq i\leq n$ construct run
    $r_{i}$ with $r_{i}(u) = r(u)$ for all $u\in T$ and
    $r_{i}(v\cdot d) = \delta(d)$ for all $d\in D$. The domain of every $r_{i}$
    is again a proper partial run and repeating this construction yields
    finitely many balanced proper partial runs $\set{r_{1},\dots, r_{m}}$ that
    agree with $r$ on $T$ and are consistent with $t$. The union of all sets
    $\compRuns(r_{i})$ for $1\leq i\leq n$ coincides with $\compRuns(r)$ and
    thus, the $\sigma$-algebra induced by balanced proper partial runs contains
    all generating set of the $\sigma$-algebra induced by proper partial runs
    rendering both algebras identical.
  \end{proof}
  As noted above we examine in the following w.l.o.g. a Büchi condition for $T$
  induced by $F\subseteq Q$. This proof re-iterates concepts of the proof for
  Lemma \ref{lem:measureabilityAcceptance} in a more complex setting. For any
  $p\in D^{*}$ fix the set of all $R_{p}\subseteq\Runs\times\Paths$ such that
  $\tuple{r,\rho}\in R_{p}$ if and only if $p\sqsubset\rho$ and for all
  $p\sqsubset u\sqsubset\rho$ holds $r(u)\notin F$. The complement of
  $\cup_{w\in D^{*}}R_{w}$ describes $f_{\mathcal{A}}^{-1}$, since every
  element $\tuple{r,p}$ in the complement of $\cup_{w\in D^{*}}R_{w}$ is not
  part of any $R_{w}$. Obviously, it is not part of those $R_{w}$ for which
  $w\not\sqsubset p$ and for those $w\sqsubset p$ all $w$ do have a prolongation
  $v$ with $w\sqsubset v\sqsubset p$ with $r(v)\in F$. If on the other hand
  $\tuple{r,p}\in f_{\mathcal{A}}^{-1}$ then $p$ is a path in $r$ which
  satisfies the Büchi condition and thus for every prefix $w\sqsubset p$ there
  is a later point $v$ with $w\sqsubset v\sqsubset p$ with $r(v)\in F$ which
  makes $\tuple{r,p}$ not part of any $R_{w}$.

  It remains to show that $R_{w}$ are measureable for every $w\in D^{*}$. Fix
  one such $w$ and for every $n>\size{w}$ gather for all balanced proper
  partial runs $r$ with depth $n$ and words $p\in D^{n}$ with $w\sqsubset p$
  and $r(p)\notin F$. The countable union of all such $\compRuns(r)$ and
  $\cyl(p)$ is collected in $C_{n}$ and we claim that
  $R_{u} = \cap_{\size{u}<n}C_{n}$ by the following argument: for any
  $\tuple{r,p}\in R_{u}$ every prolongation of $u$ that stays on $p$ does not
  visit $F$ and hence for every these prolongations $v$ we know that
  $\tuple{r,p}$ is part of $C_{\size{v}}$ and hence
  $\tuple{r,p}\in\cap_{\size{u}<n}C_{n}$. On the other hand assume
  $\tuple{r,p}\in\cap_{\size{u}<n}C_{n}$, thus for every viable prolongation
  of length $k$ for $u$ $C_{k}$ witnesses the absence of an occurence of $F$.
  
  This renders $f_{\mathcal{A}}^{-1}$ measureable and as index function for a
  measureable set integrateable in
  $\tuple{\mathcal{R}_{\mathcal{A}},\mu_{t}}\otimes
  \tuple{\mathcal{F}_{\mathcal{A}},\mu_{B}}$.
\end{proof}
